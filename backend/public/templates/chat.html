<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat Interface - Asistente UCT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            animation: {
              typing: "typing 1.5s infinite",
              "fade-in": "fade-in 0.5s ease-out",
              "slide-up": "slide-up 0.3s ease-out",
            },
            keyframes: {
              typing: {
                "0%, 60%": { opacity: "1" },
                "30%": { opacity: "0" },
              },
              "fade-in": {
                "0%": { opacity: "0", transform: "translateY(10px)" },
                "100%": { opacity: "1", transform: "translateY(0)" },
              },
              "slide-up": {
                "0%": { transform: "translateY(100%)", opacity: "0" },
                "100%": { transform: "translateY(0)", opacity: "1" },
              },
            },
          },
        },
      };

      let messageCount = 0;
      let isTyping = false;

      function toggleDarkMode() {
        document.documentElement.classList.toggle("dark");
      }

      function sendMessage() {
        const input = document.getElementById("messageInput");
        const message = input.value.trim();

        if (message && !isTyping) {
          // Añadir mensaje del usuario
          addMessage(message, "user");
          input.value = "";
          input.style.height = "auto";

          // Simular respuesta del bot
          setTimeout(() => {
            showTyping();
            setTimeout(() => {
              hideTyping();
              addBotResponse();
            }, 2000);
          }, 500);
        }
      }

      function addMessage(message, sender) {
        const chatContainer = document.getElementById("chatContainer");
        const messageDiv = document.createElement("div");
        messageDiv.className = "animate-fade-in";

        if (sender === "user") {
          messageDiv.innerHTML = `
                    <div class="flex justify-end mb-4 px-2">
                        <div class="flex items-start space-x-3 max-w-md w-auto">
                            <div class="bg-purple-600 dark:bg-purple-700 text-white rounded-2xl rounded-br-md px-4 py-3 shadow-lg break-words word-wrap">
                                <p class="text-sm leading-relaxed whitespace-pre-wrap">${message}</p>
                            </div>
                            <div class="w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-user text-purple-600 dark:text-purple-400 text-sm"></i>
                            </div>
                        </div>
                    </div>
                `;
        } else {
          messageDiv.innerHTML = `
                    <div class="flex justify-start mb-4 px-2">
                        <div class="flex items-start space-x-3 max-w-xl w-auto">
                            <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-robot text-white text-sm"></i>
                            </div>
                            <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl rounded-bl-md px-4 py-3 shadow-lg break-words word-wrap min-w-0 flex-1">
                                <p class="text-sm leading-relaxed text-gray-800 dark:text-gray-200 whitespace-pre-wrap">${message}</p>
                            </div>
                        </div>
                    </div>
                `;
        }

        chatContainer.appendChild(messageDiv);
        scrollToBottom();
      }

      function addBotResponse() {
        const responses = [
          "He analizado tu consulta y puedo generar un mapa mental sobre este tema. ¿Te gustaría que proceda con la creación?",
          "Perfecto, voy a crear un mapa mental interactivo basado en la información que me has proporcionado.",
          "Excelente pregunta. Puedo ayudarte a organizar estas ideas en un mapa conceptual. ¿Prefieres un enfoque jerárquico o temático?",
          "He procesado tu solicitud y tengo varias opciones para estructurar este contenido. Te propongo crear un mapa mental dinámico.",
        ];

        const chatContainer = document.getElementById("chatContainer");
        const messageDiv = document.createElement("div");
        messageDiv.className = "animate-fade-in";

        const randomResponse =
          responses[Math.floor(Math.random() * responses.length)];
        const showArtifact = Math.random() > 0.6; // 40% probabilidad de mostrar artefacto

        messageDiv.innerHTML = `
                <div class="flex justify-start mb-4 px-2">
                    <div class="flex items-start space-x-3 max-w-xl w-auto">
                        <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-robot text-white text-sm"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl rounded-bl-md px-4 py-3 shadow-lg break-words word-wrap min-w-0">
                            <p class="text-sm leading-relaxed text-gray-800 dark:text-gray-200 mb-3 whitespace-pre-wrap">${randomResponse}</p>
                            ${showArtifact ? createArtifactCard() : ""}
                        </div>
                    </div>
                </div>
            `;

        chatContainer.appendChild(messageDiv);
        scrollToBottom();
      }

      function createArtifactCard() {
        const artifactTypes = [
          {
            name: "Mapa Mental",
            icon: "fas fa-project-diagram",
            color: "purple",
          },
          { name: "Resumen", icon: "fas fa-file-alt", color: "emerald" },
          { name: "Análisis", icon: "fas fa-chart-line", color: "orange" },
        ];

        const artifact =
          artifactTypes[Math.floor(Math.random() * artifactTypes.length)];

        return `
                <div class="mt-3 p-3 bg-${artifact.color}-50 dark:bg-${artifact.color}-900/20 border border-${artifact.color}-200 dark:border-${artifact.color}-700 rounded-xl">
                    <div class="flex items-center justify-between flex-wrap gap-2">
                        <div class="flex items-center space-x-2 min-w-0 flex-1">
                            <i class="${artifact.icon} text-${artifact.color}-600 dark:text-${artifact.color}-400 flex-shrink-0"></i>
                            <span class="text-sm font-medium text-${artifact.color}-800 dark:text-${artifact.color}-200 truncate">${artifact.name} generado</span>
                        </div>
                        <button 
                            onclick="openModal()"
                            class="px-3 py-1.5 bg-${artifact.color}-600 hover:bg-${artifact.color}-700 text-white text-xs font-medium rounded-lg transition-colors duration-200 flex-shrink-0"
                        >
                            Ver detalle
                        </button>
                    </div>
                </div>
            `;
      }

      function showTyping() {
        if (isTyping) return;
        isTyping = true;

        const chatContainer = document.getElementById("chatContainer");
        const typingDiv = document.createElement("div");
        typingDiv.id = "typingIndicator";
        typingDiv.className = "animate-fade-in";

        typingDiv.innerHTML = `
                <div class="flex justify-start mb-4 px-2">
                    <div class="flex items-start space-x-3 max-w-xl">
                        <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-robot text-white text-sm"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl rounded-bl-md px-4 py-3 shadow-lg">
                            <div class="flex items-center space-x-1">
                                <div class="w-2 h-2 bg-gray-400 rounded-full animate-typing"></div>
                                <div class="w-2 h-2 bg-gray-400 rounded-full animate-typing" style="animation-delay: 0.2s;"></div>
                                <div class="w-2 h-2 bg-gray-400 rounded-full animate-typing" style="animation-delay: 0.4s;"></div>
                                <span class="text-xs text-gray-500 ml-2">El asistente está escribiendo...</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

        chatContainer.appendChild(typingDiv);
        scrollToBottom();
      }

      function hideTyping() {
        const typingIndicator = document.getElementById("typingIndicator");
        if (typingIndicator) {
          typingIndicator.remove();
        }
        isTyping = false;
      }

      function scrollToBottom() {
        const chatContainer = document.getElementById("chatContainer");
        setTimeout(() => {
          chatContainer.scrollTop = chatContainer.scrollHeight;
        }, 100);
      }

      function openModal() {
        alert("Modal de artefacto se abriría aquí");
      }

      function handleKeyPress(event) {
        if (event.key === "Enter" && !event.shiftKey) {
          event.preventDefault();
          sendMessage();
        }
      }

      function autoResize(textarea) {
        textarea.style.height = "auto";
        textarea.style.height = Math.min(textarea.scrollHeight, 120) + "px";
      }

      // Simular mensaje inicial
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(() => {
          addMessage(
            "¡Hola! Soy el Asistente UCT. Puedo ayudarte a crear mapas mentales, resúmenes y análisis de contenido. ¿En qué puedo ayudarte hoy?",
            "bot"
          );
        }, 1000);
      });
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
      }

      /* Scrollbar personalizada */
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }

      .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
      }

      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: rgba(156, 163, 175, 0.5);
        border-radius: 3px;
      }

      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: rgba(156, 163, 175, 0.7);
      }

      .dark .custom-scrollbar::-webkit-scrollbar-thumb {
        background: rgba(75, 85, 99, 0.5);
      }

      .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: rgba(75, 85, 99, 0.7);
      }

      /* Word wrap para mensajes largos */
      .word-wrap {
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
      }
    </style>
  </head>
  <body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <!-- Toggle Dark Mode para demo -->
    <button
      onclick="toggleDarkMode()"
      class="fixed top-4 right-4 z-50 p-3 bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-300"
    >
      <i class="fas fa-moon dark:hidden text-lg"></i>
      <i class="fas fa-sun hidden dark:block text-lg"></i>
    </button>

    <!-- Container Principal -->
    <div class="h-screen flex flex-col">
      <!-- Área del Chat -->
      <div class="flex-1 flex flex-col max-w-4xl mx-auto w-full">
        <!-- Título del Chat (opcional, se puede quitar) -->
        <div class="py-6 px-4 border-b border-gray-200 dark:border-gray-700">
          <h1
            class="text-2xl font-bold text-center text-gray-800 dark:text-white"
          >
            Chat Interface - Minimalismo Vibrante
          </h1>
          <p class="text-center text-gray-600 dark:text-gray-400 mt-1">
            Mensajes con ancho controlado y texto centrado
          </p>
        </div>

        <!-- Contenedor de Mensajes con Scroll -->
        <div
          id="chatContainer"
          class="flex-1 overflow-y-auto py-6 custom-scrollbar"
          style="max-height: calc(100vh - 200px)"
        >
          <!-- Los mensajes se añaden aquí dinámicamente -->
        </div>

        <!-- Área de Input Fija -->
        <div
          class="border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 p-4"
        >
          <!-- Botones de Acción Rápida -->
          <div class="flex flex-wrap gap-2 mb-4">
            <button
              onclick="document.getElementById('messageInput').value = 'Crea un mapa mental sobre inteligencia artificial'; autoResize(document.getElementById('messageInput'));"
              class="flex items-center space-x-2 px-3 py-1.5 bg-white dark:bg-gray-800 hover:bg-purple-50 dark:hover:bg-purple-900/20 text-purple-600 dark:text-purple-400 text-xs font-medium rounded-lg border border-purple-200 dark:border-purple-700 hover:border-purple-400 dark:hover:border-purple-500 transition-all duration-300"
            >
              <i class="fas fa-project-diagram"></i>
              <span>Mapa Mental</span>
            </button>

            <button
              onclick="document.getElementById('messageInput').value = 'Genera un resumen de este texto'; autoResize(document.getElementById('messageInput'));"
              class="flex items-center space-x-2 px-3 py-1.5 bg-white dark:bg-gray-800 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 text-xs font-medium rounded-lg border border-emerald-200 dark:border-emerald-700 hover:border-emerald-400 dark:hover:border-emerald-500 transition-all duration-300"
            >
              <i class="fas fa-file-alt"></i>
              <span>Resumen</span>
            </button>

            <button
              onclick="document.getElementById('messageInput').value = 'Analiza estos datos y crea visualizaciones'; autoResize(document.getElementById('messageInput'));"
              class="flex items-center space-x-2 px-3 py-1.5 bg-white dark:bg-gray-800 hover:bg-orange-50 dark:hover:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs font-medium rounded-lg border border-orange-200 dark:border-orange-700 hover:border-orange-400 dark:hover:border-orange-500 transition-all duration-300"
            >
              <i class="fas fa-chart-line"></i>
              <span>Análisis</span>
            </button>
          </div>

          <!-- Input Principal -->
          <div class="relative">
            <div
              class="flex items-end space-x-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl p-3 shadow-lg"
            >
              <!-- Área de Texto -->
              <div class="flex-1">
                <textarea
                  id="messageInput"
                  placeholder="Escribe tu mensaje aquí... (Enter para enviar, Shift+Enter para nueva línea)"
                  class="w-full resize-none bg-transparent text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none text-sm leading-relaxed py-1 px-1"
                  rows="1"
                  onkeypress="handleKeyPress(event)"
                  oninput="autoResize(this)"
                  style="min-height: 24px; max-height: 120px; line-height: 1.5"
                ></textarea>
              </div>

              <!-- Botón Enviar -->
              <button
                onclick="sendMessage()"
                class="p-2.5 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-xl transition-all duration-300 transform hover:scale-105 flex-shrink-0"
              >
                <i class="fas fa-paper-plane text-sm"></i>
              </button>
            </div>

            <!-- Indicadores adicionales -->
            <div
              class="flex justify-between items-center mt-2 text-xs text-gray-500 dark:text-gray-400"
            >
              <div class="flex items-center space-x-4">
                <span class="flex items-center space-x-1">
                  <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                  <span>Bot en línea</span>
                </span>
                <span>Enter para enviar</span>
              </div>
              <div class="flex items-center space-x-1">
                <i class="fas fa-shield-alt text-green-500"></i>
                <span>Conversación segura</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
